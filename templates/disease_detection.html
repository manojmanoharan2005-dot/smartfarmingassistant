{% extends "base.html" %}

{% block title %}Disease Detection - Smart Farming Assistant{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/disease.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <div class="disease-detection-form">
        <h2>ðŸ¦  Plant Disease Detection</h2>
        <p>Upload a photo of your plant to detect diseases and get treatment recommendations.</p>
        
        <form method="POST" enctype="multipart/form-data" id="diseaseForm">
            <div class="upload-area">
                <div class="upload-box" id="uploadBox">
                    <input type="file" id="disease_image" name="disease_image" accept="image/*" required>
                    <div class="upload-text">
                        <p>ðŸ“· Click to upload or drag and drop</p>
                        <p>Supported formats: JPG, PNG, GIF</p>
                    </div>
                </div>
                <div id="imagePreview" class="image-preview-container"></div>
            </div>
            
            <button type="submit" class="btn btn-primary" id="submitBtn" disabled>
                Detect Disease
            </button>
        </form>
    </div>
</div>

<script>
document.getElementById('disease_image').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const submitBtn = document.getElementById('submitBtn');
    const preview = document.getElementById('imagePreview');
    
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.innerHTML = `<img src="${e.target.result}" alt="Preview" class="preview-image">`;
            submitBtn.disabled = false;
        };
        reader.readAsDataURL(file);
    }
});

// Drag and drop functionality
const uploadBox = document.getElementById('uploadBox');
uploadBox.addEventListener('dragover', function(e) {
    e.preventDefault();
    uploadBox.style.backgroundColor = '#f0f8f0';
});

uploadBox.addEventListener('dragleave', function(e) {
    uploadBox.style.backgroundColor = '';
});

uploadBox.addEventListener('drop', function(e) {
    e.preventDefault();
    uploadBox.style.backgroundColor = '';
    
    const files = e.dataTransfer.files;
    if (files.length > 0) {
        document.getElementById('disease_image').files = files;
        document.getElementById('disease_image').dispatchEvent(new Event('change'));
    }
});
</script>
{% endblock %}
