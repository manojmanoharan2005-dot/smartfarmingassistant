{% extends "base.html" %}

{% block title %}Start Growing {{ crop_name }} - Smart Farming Assistant{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/crop.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <div class="crop-timeline-form">
        <h2>ðŸŒ± Start Growing {{ crop_name }}</h2>
        <p>Success Probability: {{ "%.1f"|format(probability * 100) }}%</p>
        
        <form action="{{ url_for('crop.crop_timeline') }}" method="POST">
            <input type="hidden" name="crop_name" value="{{ crop_name }}">
            <input type="hidden" name="probability" value="{{ probability }}">
            
            <div class="form-group">
                <label for="sowing_date">Sowing Date:</label>
                <input type="date" id="sowing_date" name="sowing_date" required>
            </div>
            
            <h3>Create Task Timeline:</h3>
            <div id="timeline-container">
                <div class="timeline-week">
                    <h4>Week 1</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Task:</label>
                            <input type="text" name="week_1_task" placeholder="e.g., Soil preparation" required>
                        </div>
                        <div class="form-group">
                            <label>Date:</label>
                            <input type="date" name="week_1_date" required>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="timeline-actions">
                <button type="button" onclick="addWeek()" class="btn btn-secondary">Add Week</button>
                <button type="button" onclick="removeWeek()" class="btn btn-danger">Remove Week</button>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn btn-success">Start Monitoring</button>
                <a href="{{ url_for('crop.crop_suggestion') }}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

<script>
let weekCount = 1;

function addWeek() {
    weekCount++;
    const container = document.getElementById('timeline-container');
    const weekDiv = document.createElement('div');
    weekDiv.className = 'timeline-week';
    weekDiv.innerHTML = `
        <h4>Week ${weekCount}</h4>
        <div class="form-row">
            <div class="form-group">
                <label>Task:</label>
                <input type="text" name="week_${weekCount}_task" placeholder="e.g., Watering, Fertilizing" required>
            </div>
            <div class="form-group">
                <label>Date:</label>
                <input type="date" name="week_${weekCount}_date" required>
            </div>
        </div>
    `;
    container.appendChild(weekDiv);
}

function removeWeek() {
    if (weekCount > 1) {
        const container = document.getElementById('timeline-container');
        container.removeChild(container.lastElementChild);
        weekCount--;
    }
}
</script>
{% endblock %}
